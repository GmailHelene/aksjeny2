<div class="analysis-menu mb-4">
    <div class="card">
        <div class="card-body py-2">
            <!-- Desktop Navigation -->
            <div class="d-none d-lg-flex flex-wrap align-items-center gap-2">
                <a href="{{ url_for('analysis.index') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.index' else 'btn-outline-primary' }}">
                    <i class="bi bi-house me-1"></i>Oversikt
                </a>
                <a href="{{ url_for('analysis.market_overview') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.market_overview' else 'btn-outline-primary' }}">
                    <i class="bi bi-globe me-1"></i>Markedsoversikt
                </a>
                <a href="{{ url_for('analysis.technical') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.technical' else 'btn-outline-primary' }}">
                    <i class="bi bi-graph-up me-1"></i>Teknisk
                </a>
                <a href="{{ url_for('analysis.fundamental') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.fundamental' else 'btn-outline-primary' }}">
                    <i class="bi bi-calculator me-1"></i>Fundamental
                </a>
                <a href="{{ url_for('analysis.warren_buffett') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.warren_buffett' else 'btn-outline-primary' }}">
                    <i class="bi bi-person-check me-1"></i>Warren Buffett
                </a>
                <a href="{{ url_for('analysis.benjamin_graham') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.benjamin_graham' else 'btn-outline-primary' }}">
                    <i class="bi bi-book me-1"></i>Benjamin Graham
                </a>
                <a href="{{ url_for('analysis.ai') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.ai' else 'btn-outline-primary' }}">
                    <i class="bi bi-cpu me-1"></i>AI-Analyse
                </a>
                <a href="{{ url_for('analysis.short_analysis') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.short_analysis' else 'btn-outline-primary' }}">
                    <i class="bi bi-graph-down me-1"></i>Short
                </a>
                <a href="{{ url_for('analysis.sentiment') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.sentiment' else 'btn-outline-primary' }}">
                    <i class="bi bi-emoji-smile me-1"></i>Sentiment
                </a>
                <a href="{{ url_for('analysis.prediction') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.prediction' else 'btn-outline-primary' }}">
                    <i class="bi bi-crystal-ball me-1"></i>AI Prediksjoner
                </a>
                <a href="{{ url_for('analysis.recommendation', ticker=ticker) if ticker else url_for('analysis.recommendation') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.recommendation' else 'btn-outline-primary' }}">
                    <i class="bi bi-star me-1"></i>Anbefalinger
                </a>
                <a href="{{ url_for('analysis.screener') }}" class="btn btn-sm {{ 'btn-primary' if request.endpoint == 'analysis.screener' else 'btn-outline-primary' }}">
                    <i class="bi bi-funnel me-1"></i>Screener
                </a>
                
                <!-- Desktop Ticker Input -->
                <div class="d-flex align-items-center ms-auto">
                    <label for="ticker-input" class="form-label me-2 mb-0 small text-muted">Ticker:</label>
                    <input type="text" id="ticker-input" class="form-control form-control-sm" placeholder="f.eks. AAPL" style="width: 120px;">
                    <button type="button" class="btn btn-sm btn-outline-secondary ms-2" onclick="analyzeCustomTicker()">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div class="d-lg-none">
                <!-- Primary Actions Row -->
                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <a href="{{ url_for('analysis.index') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.index' else 'btn-outline-primary' }}" style="padding: 0.6rem 0.5rem; font-size: 0.8rem;">
                            <i class="bi bi-house d-block mb-1"></i><small>Oversikt</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('analysis.technical') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.technical' else 'btn-outline-primary' }}" style="padding: 0.6rem 0.5rem; font-size: 0.8rem;">
                            <i class="bi bi-graph-up d-block mb-1"></i><small>Teknisk</small>
                        </a>
                    </div>
                </div>
                
                <!-- Analysis Tools Row -->
                <div class="row g-2 mb-3">
                    <div class="col-4">
                        <a href="{{ url_for('analysis.fundamental') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.fundamental' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-calculator d-block mb-1"></i><small>Fundamental</small>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="{{ url_for('analysis.warren_buffett') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.warren_buffett' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-person-check d-block mb-1"></i><small>W. Buffett</small>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="{{ url_for('analysis.benjamin_graham') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.benjamin_graham' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-book d-block mb-1"></i><small>B. Graham</small>
                        </a>
                    </div>
                </div>
                
                <!-- More Tools Row -->
                <div class="row g-2 mb-3">
                    <div class="col-4">
                        <a href="{{ url_for('analysis.ai') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.ai' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-cpu d-block mb-1"></i><small>AI-Analyse</small>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="{{ url_for('analysis.short_analysis') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.short_analysis' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-graph-down d-block mb-1"></i><small>Short</small>
                        </a>
                    </div>
                    <div class="col-4">
                        <a href="{{ url_for('analysis.sentiment') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.sentiment' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-emoji-smile d-block mb-1"></i><small>Sentiment</small>
                        </a>
                    </div>
                </div>

                <!-- Market Overview Row -->
                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <a href="{{ url_for('analysis.market_overview') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.market_overview' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-grid-3x3 d-block mb-1"></i><small>Markedsoversikt</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('analysis.screener') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.screener' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-funnel d-block mb-1"></i><small>Screener</small>
                        </a>
                    </div>
                </div>
                
                <!-- Final Tools Row -->
                <div class="row g-2 mb-3">
                    <div class="col-6">
                        <a href="{{ url_for('analysis.prediction') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.prediction' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-crystal-ball d-block mb-1"></i><small>Prediksjoner</small>
                        </a>
                    </div>
                    <div class="col-6">
                        <a href="{{ url_for('analysis.recommendation', ticker=ticker) if ticker else url_for('analysis.recommendation') }}" class="btn btn-sm w-100 {{ 'btn-primary' if request.endpoint == 'analysis.recommendation' else 'btn-outline-primary' }}" style="padding: 0.5rem 0.3rem; font-size: 0.75rem;">
                            <i class="bi bi-star d-block mb-1"></i><small>Anbefalinger</small>
                        </a>
                    </div>
                </div>
                
                <!-- Mobile Ticker Input -->
                <div class="input-group input-group-sm">
                    <span class="input-group-text bg-primary text-white border-primary">
                        <i class="bi bi-search"></i>
                    </span>
                    <input type="text" id="ticker-input-mobile" class="form-control border-primary" placeholder="SÃ¸k ticker (f.eks. AAPL)" style="font-size: 16px;">
                    <button type="button" class="btn btn-primary" onclick="analyzeCustomTickerMobile()">
                        <i class="bi bi-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function analyzeCustomTicker() {
    const ticker = document.getElementById('ticker-input').value.trim().toUpperCase();
    if (ticker) {
        redirectToAnalysis(ticker);
    } else {
        alert('Vennligst skriv inn en ticker (f.eks. AAPL)');
    }
}

function analyzeCustomTickerMobile() {
    const ticker = document.getElementById('ticker-input-mobile').value.trim().toUpperCase();
    if (ticker) {
        redirectToAnalysis(ticker);
    } else {
        alert('Vennligst skriv inn en ticker (f.eks. AAPL)');
    }
}

function redirectToAnalysis(ticker) {
    // Get current path to determine which analysis to use
    const currentPath = window.location.pathname;
    let targetRoute = '';
    
    if (currentPath.includes('/technical')) {
        targetRoute = `/analysis/technical?ticker=${ticker}`;
    } else if (currentPath.includes('/warren-buffett')) {
        targetRoute = `/analysis/warren-buffett?ticker=${ticker}`;
    } else if (currentPath.includes('/benjamin-graham')) {
        targetRoute = `/analysis/benjamin-graham?ticker=${ticker}`;
    } else if (currentPath.includes('/short-analysis')) {
        targetRoute = `/analysis/short-analysis?ticker=${ticker}`;
    } else if (currentPath.includes('/sentiment')) {
        targetRoute = `/analysis/sentiment?symbol=${ticker}`;
    } else if (currentPath.includes('/ai')) {
        targetRoute = `/analysis/ai?ticker=${ticker}`;
    } else if (currentPath.includes('/recommendation')) {
        targetRoute = `/analysis/recommendation/${ticker}`;
    } else {
        // Default to technical analysis
        targetRoute = `/analysis/technical?ticker=${ticker}`;
    }
    
    window.location.href = targetRoute;
}

// Allow Enter key to trigger analysis on both inputs
document.addEventListener('DOMContentLoaded', function() {
    const desktopInput = document.getElementById('ticker-input');
    const mobileInput = document.getElementById('ticker-input-mobile');
    
    if (desktopInput) {
        desktopInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeCustomTicker();
            }
        });
    }
    
    if (mobileInput) {
        mobileInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeCustomTickerMobile();
            }
        });
    }
});
</script>