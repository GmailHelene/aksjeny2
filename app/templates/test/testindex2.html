{% extends "base.html" %}
{% set title = "Test Homepage Layout 2" %}

{% block content %}
<div class="container-fluid">
    <!-- Compact Hero -->
    <div class="row mb-3">
        <div class="col-12">
            <div class="alert alert-primary text-center mb-0" role="alert">
                <h2 class="mb-1">üìä Test Homepage Layout 2</h2>
                <p class="mb-2">Kompakt design med fokus p√• data</p>
            </div>
        </div>
    </div>

    <!-- Primary Market Data Grid -->
    <div class="row">
        <!-- Left Column: Oslo B√∏rs & Global -->
        <div class="col-lg-8">
            <!-- Oslo B√∏rs -->
            <div class="card mb-3">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">üá≥üá¥ Oslo B√∏rs - Topp 15</h5>
                    <small>Sanntidsdata</small>
                </div>
                <div class="card-body p-0">
                    {% if oslo_stocks %}
                        <div class="table-responsive">
                            <table class="table table-striped table-hover mb-0">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Ticker</th>
                                        <th>Navn</th>
                                        <th>Pris (NOK)</th>
                                        <th>Endring</th>
                                        <th>%</th>
                                        <th>Volum</th>
                                        <th>Signal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for stock in oslo_stocks %}
                                    <tr>
                                        <td><strong class="text-primary">{{ stock.ticker or stock.symbol }}</strong></td>
                                        <td class="text-muted">{{ stock.name[:20] if stock.name else stock.ticker }}</td>
                                        <td><strong>{{ "%.2f"|format(stock.last_price) if stock.last_price else "N/A" }}</strong></td>
                                        <td class="{% if stock.change > 0 %}text-success{% elif stock.change < 0 %}text-danger{% endif %}">
                                            {{ "+%.2f"|format(stock.change) if stock.change > 0 else "%.2f"|format(stock.change) if stock.change else "N/A" }}
                                        </td>
                                        <td class="{% if stock.change_percent > 0 %}text-success{% elif stock.change_percent < 0 %}text-danger{% endif %}">
                                            {{ "+%.1f%"|format(stock.change_percent) if stock.change_percent > 0 else "%.1f%"|format(stock.change_percent) if stock.change_percent else "N/A" }}
                                        </td>
                                        <td class="text-muted">{{ "{:,}".format(stock.volume) if stock.volume else "N/A" }}</td>
                                        <td>
                                            {% if stock.signal == 'BUY' %}
                                                <span class="badge bg-success">KJ√òP</span>
                                            {% elif stock.signal == 'SELL' %}
                                                <span class="badge bg-danger">SELG</span>
                                            {% else %}
                                                <span class="badge bg-secondary">HOLD</span>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="p-3 text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Laster Oslo B√∏rs data...
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Global Stocks -->
            <div class="card mb-3">
                <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">üåç Globale Aksjer - Topp 15</h5>
                    <small>NYSE, NASDAQ</small>
                </div>
                <div class="card-body p-0">
                    {% if global_stocks %}
                        <div class="table-responsive">
                            <table class="table table-striped table-hover mb-0">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Ticker</th>
                                        <th>Navn</th>
                                        <th>Pris (USD)</th>
                                        <th>Endring</th>
                                        <th>%</th>
                                        <th>Volum</th>
                                        <th>Signal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for stock in global_stocks %}
                                    <tr>
                                        <td><strong class="text-success">{{ stock.ticker or stock.symbol }}</strong></td>
                                        <td class="text-muted">{{ stock.name[:20] if stock.name else stock.ticker }}</td>
                                        <td><strong>${{ "%.2f"|format(stock.last_price) if stock.last_price else "N/A" }}</strong></td>
                                        <td class="{% if stock.change > 0 %}text-success{% elif stock.change < 0 %}text-danger{% endif %}">
                                            {{ "+%.2f"|format(stock.change) if stock.change > 0 else "%.2f"|format(stock.change) if stock.change else "N/A" }}
                                        </td>
                                        <td class="{% if stock.change_percent > 0 %}text-success{% elif stock.change_percent < 0 %}text-danger{% endif %}">
                                            {{ "+%.1f%"|format(stock.change_percent) if stock.change_percent > 0 else "%.1f%"|format(stock.change_percent) if stock.change_percent else "N/A" }}
                                        </td>
                                        <td class="text-muted">{{ "{:,}".format(stock.volume) if stock.volume else "N/A" }}</td>
                                        <td>
                                            {% if stock.signal == 'BUY' %}
                                                <span class="badge bg-success">BUY</span>
                                            {% elif stock.signal == 'SELL' %}
                                                <span class="badge bg-danger">SELL</span>
                                            {% else %}
                                                <span class="badge bg-secondary">HOLD</span>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="p-3 text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Laster globale aksjer...
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Right Column: Crypto & Tools -->
        <div class="col-lg-4">
            <!-- Crypto -->
            <div class="card mb-3">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">‚Çø Kryptovaluta</h5>
                </div>
                <div class="card-body p-0">
                    {% if crypto_data %}
                        <div class="table-responsive">
                            <table class="table table-sm table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Coin</th>
                                        <th>Pris</th>
                                        <th>24h %</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for crypto in crypto_data %}
                                    <tr>
                                        <td>
                                            <strong>{{ crypto.symbol }}</strong><br>
                                            <small class="text-muted">{{ crypto.name[:15] if crypto.name else crypto.symbol }}</small>
                                        </td>
                                        <td><strong>${{ "%.2f"|format(crypto.last_price) if crypto.last_price and crypto.last_price > 1 else "%.4f"|format(crypto.last_price) if crypto.last_price else "N/A" }}</strong></td>
                                        <td class="{% if crypto.change_percent > 0 %}text-success{% elif crypto.change_percent < 0 %}text-danger{% endif %}">
                                            <strong>{% if crypto.change_percent > 0 %}+{{ "%.1f"|format(crypto.change_percent) }}%{% else %}{{ "%.1f"|format(crypto.change_percent) }}%{% endif %}</strong>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="p-3 text-center text-muted">
                            <i class="fas fa-spinner fa-spin"></i> Laster crypto...
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Quick Tools -->
            <div class="card mb-3">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">üöÄ Hurtigverkt√∏y</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('analysis.index') }}" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-chart-line"></i> Aksjeanalyse
                        </a>
                        <a href="{{ url_for('portfolio.index') }}" class="btn btn-outline-success btn-sm">
                            <i class="fas fa-briefcase"></i> Min Portfolio
                        </a>
                        <a href="{{ url_for('stocks.compare') }}" class="btn btn-outline-info btn-sm">
                            <i class="fas fa-balance-scale"></i> Sammenlign Aksjer
                        </a>
                        <a href="{{ url_for('price_alerts.index') }}" class="btn btn-outline-warning btn-sm">
                            <i class="fas fa-bell"></i> Prisvarsler
                        </a>
                    </div>
                </div>
            </div>

            <!-- Trending if available -->
            {% if trending_stocks %}
            <div class="card">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0">üî• Trending</h5>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        {% for stock in trending_stocks %}
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>{{ stock.symbol }}</strong><br>
                                <small class="text-muted">{{ stock.name[:20] if stock.name else stock.symbol }}</small>
                            </div>
                            <div class="text-end">
                                <strong>{{ "%.2f"|format(stock.last_price) if stock.last_price else "N/A" }}</strong><br>
                                <small class="{% if stock.change_percent > 0 %}text-success{% elif stock.change_percent < 0 %}text-danger{% endif %}">
                                    {{ "+%.1f%"|format(stock.change_percent) if stock.change_percent > 0 else "%.1f%"|format(stock.change_percent) if stock.change_percent else "N/A" }}
                                </small>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card bg-light">
                <div class="card-body text-center">
                    <h5>Avanserte Funksjoner</h5>
                    <div class="row">
                        <div class="col-md-3">
                            <a href="{{ url_for('analysis.ai') }}" class="btn btn-primary btn-sm mb-2">AI Prediksjon</a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('analysis.technical') }}" class="btn btn-success btn-sm mb-2">Teknisk Analyse</a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('analysis.sentiment') }}" class="btn btn-info btn-sm mb-2">Sentiment</a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('analysis.screener') }}" class="btn btn-warning btn-sm mb-2 text-dark">Screener</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
